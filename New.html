<html>

<head>
    <script src="/socket.io/socket.io.js"></script>
    <link rel="stylesheet" href="styles/style.css">
</head>

<body>
    <div class="header">
        <a href="New.html" class="btn">project</a>
        <a href="action.html" class="btn">Cash in /Cash out</a>
        <a href="statment.html" class="btn">Statment</a>
    </div>
    <h1>select an option</h1>
    <div>
        <button id="create">create project</button>
        <button id="delete">delete project</button>
    </div>
    <br><br>

    <form action="" id="form" style="display: none;">
        <label for="">project name</label>
        <input type="text" id="projectName" placeholder="This project is by the name of whom">
        <br>
        <label for="">Umi starting loan</label>
        <input type="number" id="aishaLoan" placeholder="Starting loan">
        <br>

        <label for="">Abaa starting loan</label>
        <input type="number" id="abaaLoan" placeholder="Starting loan">
        <br>
        <label for="">Starting date</label>
        <input type="date" id="date">
        <br>
        <button id="Submit">Submit</button>

    </form>

    <form action="" id="form2" style="display: none;">
        <label for="">project name</label>
        <input type="text" id="projectName2" placeholder="This project is by the name of whom">
        <br>
        <button id="Submit2">Submit</button>

    </form>



    <script>
        const socket = io()
        let username = "";
        const storedUsername = localStorage.getItem("username");
        if (storedUsername !== null) {
            username = storedUsername;
        }
        socket.emit("checkuser", username)

        socket.on("goLogin", (path) => {
            //locate the user to the path
            window.location = `./${path}`;
        })


        //display forms
        document.getElementById("create").addEventListener("click", () => {
            document.getElementById("form").style.display = "flex";
            document.getElementById("form2").style.display = "none";
        })
        document.getElementById("delete").addEventListener("click", () => {
            document.getElementById("form2").style.display = "flex";
            document.getElementById("form").style.display = "none";
        })




        //getting the values
        document.getElementById("Submit").addEventListener("click", () => {

            event.preventDefault()
            let abaaLoan = 0
            let umiLoan = 0
            let projectname = ""
            let date = ""


            let abaa = document.getElementById("abaaLoan").value
            let umi = document.getElementById("aishaLoan").value
            let project = document.getElementById("projectName").value
            let datee = document.getElementById("date").value

            if (abaa != null)
                abaaLoan = abaa
            if (umi != null)
                umiLoan = umi
            if (project != null)
                projectname = project
            else {
                alert("project name cannot be empty")
                return;
            }
            if (datee != null)
                date = datee
            else {
                alert("date cannot be empty")
                return;
            }


            console.log("will store")
            socket.emit("storeProject", { abaaLoan, umiLoan, projectname, date })
            socket.once("projectRespones", (message) => {

                alert(message)
                return
            })

        })

        document.getElementById("Submit2").addEventListener("click", () => {
            event.preventDefault();

            let project = ""
            if (document.getElementById("projectName2").value == null) {
                alert("project name connot be empty")
                return
            }

            else
                project = document.getElementById("projectName2").value

            socket.emit("removeProject", project)
            socket.once("projectRespones", (message) => {

                alert(message)
                return
            })

        })


    </script>
</body>

</html>